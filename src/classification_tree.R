## ----setup, include=FALSE--------------------------------------------------------------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)


## --------------------------------------------------------------------------------------------------------------------------------
data(iris)
library(ggplot2)
library(caret)


## --------------------------------------------------------------------------------------------------------------------------------
table(iris$Species)


## --------------------------------------------------------------------------------------------------------------------------------
inTrain <- createDataPartition(iris$Species, p = 0.7, list = FALSE)
training <- iris[inTrain,]
testing <- iris[-inTrain,]



## --------------------------------------------------------------------------------------------------------------------------------
ggplot(training, aes(Petal.Width, Sepal.Width, color = Species)) + geom_point()


## --------------------------------------------------------------------------------------------------------------------------------
modFit <- train(Species ~ ., method = "rpart", data = training)
modFit$finalModel


## --------------------------------------------------------------------------------------------------------------------------------
plot(modFit$finalModel, uniform = TRUE, main = "Classification Tree")
text(modFit$finalModel, use.n = TRUE, cex = .8)


## --------------------------------------------------------------------------------------------------------------------------------
# library(rattle)
# fancyRpartPlot(modFit$finalModel)


## --------------------------------------------------------------------------------------------------------------------------------
predict(modFit, newdata = testing)

